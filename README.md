# Описание проекта

Проект направлен на построение модели классификации, которая по набору характеристик мобильного устройства определяет его ценовой диапазон (price_range).
[Исходная выборка данных](https://www.kaggle.com/datasets/iabhishekofficial/mobile-price-classification/code)

## Запуск

Для запуска проекта под ОС GNU/Linux необходимо выполнить команды:

```shell
git clone https://github.com/PodlubnyAY/mobile-price-classification.git
cd mobile-price-classification
python -m venv .venv
source .venv/bin/activate
python -m pip install -r requirements.txt
```

Для активации виртуального окружения используется команда:

```shell
source .venv/bin/activate
```

Для деактивации:

```shell
deactivate
```

## Исследование данных

В ходе исследования были проведены действия:

- Удалены записи с неположительным значением ёмкости аккумулятора, памяти, толщины телефона
- Удалены записи с горизонтальным разрешением большим вертикального
- Были удалены столбцы ``clock_speed``, ``fc``, ``int_memory``, ``m_deep``, ``n_cores``, ``sc_h``, ``sc_w``, ``talk_time``
- Номинальные признаки `blue`, `wifi`, `dual_sim`, `three_g` `four_g`, `touch_screen` были приведены из `int64` к `int8`

В ходе анализа были выявлены следующие закономерности:

- Данные распределены неравномерно, сильно выделяются `battery_power`, `px_height`, `px_width`, `ram`. Эти признаки имеют гораздо больший разброс значений. (см. [график](./eda/numeric_features_boxplot.png))
- Признаки `fc`, `px_height` имеют выбросы (значения, превышающие 1.5 IQR, где IQR - межквартильное расстояние, т.е. разность между значениями квартиля 3 и квартиля 1) (см. [график](./eda/numeric_features_boxplot.png))

- Наибольшую корреляцию с ценовой категорией имеют `RAM` (0.917), `battery_power` (0.199), `px_width` (0.166) и `px_height` (0.146) (см. [график](./eda/correlation_thresholded.png))
- Наибольшее влияние на цену телефона имеет объем оперативной памяти и разрешение экрана (см. [график](./eda/correlation.png))

- Малое число телефонов из выборки имеют хорошую фронтальную камеру (см. [график](./eda/features_dist.png))
- С увеличением `px_width` увеличивается количество экземпляров из категории 3. (см. [график](./eda/features_dist.png))
- Все номинальные признаки распределены равномерно по ценовым категориям (см. [график](/eda/features_dist.png) )

- на основе [графика](./eda/features_dist.png) составили среднего представителя флагмана (с наличием всех номинальных признаков) с ценовой категорией 3:
  - высокий `battery_power`
  - низкий `fc`
  - высокий `pc`
  - `px_height` от 250 до 750
  - `ram` более 3000
  - `px_width` от 1000 до 2000

- низкофункциональные модели (отсутствие все номинальных признаков) не выделяются относительно ценовых категорий (см. [график](./eda/underline_dist.png))

- Обработанная выборка сохранена в файл ./data/clean_data.pkl

[Подробнее](./eda/eda.ipynb)

## Запуск mlflow

Для запуска сервера необходимо перейти в директорию `mlflow` и выполнить bash-скрипт `start_mlflow.sh`

```shell
cd mlflow && $SHELL start_mlflow.sh
```

## Результаты исследования

Лучший результат показала модель `10 selected features`
со значением целевой метрики `f1-score` = 0.87

После подброда параметров удалось улучшить точность до 0.88
с параметрами: \
`n_estimators`: 74, `max_depth`: 22, `max_features`: 0.797474612969723

run_id = `4d4beea10f1349d2b37e66eaf065dfa7`
